# Финальный проект. Прогноз оттока клиентов
## Цель
Оператор связи «ТелеДом» хочет бороться с оттоком клиентов. Для этого его сотрудники начнут предлагать промокоды и специальные условия всем, кто планирует отказаться от услуг связи. Чтобы заранее находить таких пользователей, «ТелеДому» нужна модель, которая будет предсказывать, разорвёт ли абонент договор. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и услугах.
Наша задача — обучить на этих данных модель для прогноза оттока клиентов.
## Вывод
Для выполнения нашей задачи - обучения модели для прогноза оттока клиентов нами было выполнено несколько шагов. Первым из которых была загрузка данных их осмотр с помощью методов describe(), info() и head(). Далее на этапе предобработки данных мы объединили все данные в один датафрейм, заполнили пропуски, изменили типы данных в столбцах, где это необходимо было сделать, проверили датафрейм на наличие дубликатов и аномалий и ошибок. А также создали два новых признака - target и duration_d. Далее нами был проведен исследовательский анализ данных, где мы построили гистограммы и диаграммы Boxplot для всех численых данных, а также круговые диаграммы для всех категориальных данных. После чего мы подготовили данные для обучения выделив 2 выборки - тренировочную и тестовую и создали 3 модели классификации: модель Логистической регресии, LGBMClassifier и CatBoostClassifier. Эти модели показали следующие значения метрики ROC-AUC на кроссвалидации:
* Логистическая регрессия:
     + Лучшие параметры: {'C': 0.01, 'fit_intercept': True, 'penalty': 'l1', 'solver': 'saga'}
     + Лучший показатель метрики AUC-ROC: 0.648
* LGBMClassifier:
    + Лучшие параметры: {'learning_rate': 0.3, 'max_depth': 4, 'n_estimators': 200, 'reg_alpha': 1}
    + Лучший показатель метрики AUC-ROC: 0.891
* CatBoostClassifier:
    + Лучшие параметры: {'depth': 4, 'iterations': 200, 'l2_leaf_reg': 1, 'learning_rate': 0.5}
    + Лучший показатель метрики AUC-ROC: 0.911  
    

Лучшей моделью на кросвалидации оказалась CatBoostClassifier, именно ее качество мы и проверили на тестовой выборке и для нее построили график важности признаков.   
Итоговой моделью стала CatBoostClassifier с гиперпараметрами {'depth': 4, 'iterations': 200, 'l2_leaf_reg': 1, 'learning_rate': 0.5}, обученная на признаках ['Type', 'PaperlessBilling', 'PaymentMethod', 'MonthlyCharges', 'TotalCharges', 'gender', 'SeniorCitizen', 'Partner', 'Dependents', 'InternetService', 'OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies', 'MultipleLines', 'duration_m'], самыми важнами из которых оказались 'duration_m', 'MonthlyCharges' и 'TotalCharges'. Модель показала значение метрики ROC-AUC 0.9181339999479207, что проходит порог в 0.85
## Используемые инструменты
Pandas, matplotlib, numpy, sklearn, LogisticRegression, RandomForestClassifier, CatBoostClassifier, LGBMClassifier

## Статус проекта 
**Завершен**
